

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Calibrating Flow Cytometry Data to MEF &mdash; FlowCal 1.1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/my_style.css" type="text/css" />
  

  
    <link rel="top" title="FlowCal 1.1.0 documentation" href="../index.html"/>
        <link rel="up" title="FlowCal’s Python API Tutorial" href="index.html"/>
        <link rel="next" title="Processing FCS Files with the Excel UI" href="excel_ui.html"/>
        <link rel="prev" title="Gating Flow Cytometry Data" href="gate.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> FlowCal
          

          
          </a>

          
            
            
              <div class="version">
                1.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fundamentals/index.html">Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../excel_ui/index.html">FlowCal&#8217;s Excel UI</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">FlowCal&#8217;s Python API Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="read.html">Reading Flow Cytometry Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="transform.html">Transforming Flow Cytometry Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot.html">Plotting Flow Cytometry Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="gate.html">Gating Flow Cytometry Data</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Calibrating Flow Cytometry Data to MEF</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#working-with-calibration-beads">Working with Calibration Beads</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mef-transformation-in-flowcal">MEF Transformation in <code class="docutils literal"><span class="pre">FlowCal</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#generation-of-a-mef-transformation-function">Generation of a MEF Transformation Function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#identification-of-bead-subpopulations">1. Identification of Bead Subpopulations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#calculation-of-population-statistics">2. Calculation of Population Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#population-selection">3. Population Selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#standard-curve-calculation">4. Standard Curve Calculation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="excel_ui.html">Processing FCS Files with the Excel UI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/modules.html">FlowCal (Python API) Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">Contribute</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">FlowCal</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">FlowCal&#8217;s Python API Tutorial</a> &raquo;</li>
      
    <li>Calibrating Flow Cytometry Data to MEF</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/python_tutorial/mef.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="calibrating-flow-cytometry-data-to-mef">
<h1>Calibrating Flow Cytometry Data to MEF<a class="headerlink" href="#calibrating-flow-cytometry-data-to-mef" title="Permalink to this headline">¶</a></h1>
<p>This tutorial focuses on how to transform flow cytometry data to Molecules of Equivalent Fluorophore (MEF) using <code class="docutils literal"><span class="pre">FlowCal</span></code>, particularly by using the module <a class="reference internal" href="../reference/FlowCal.mef.html#module-FlowCal.mef" title="FlowCal.mef"><code class="xref py py-mod docutils literal"><span class="pre">FlowCal.mef</span></code></a>. For more information on MEF calibration, see the section on <a class="reference internal" href="../fundamentals/calibration.html"><em>fundamentals of calibration</em></a>.</p>
<p>To start, navigate to the <code class="docutils literal"><span class="pre">examples</span></code> directory included with FlowCal, and open a <code class="docutils literal"><span class="pre">python</span></code> session therein. Then, import <code class="docutils literal"><span class="pre">FlowCal</span></code> as with any other python module.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">FlowCal</span>
</pre></div>
</div>
<p>Also, import <code class="docutils literal"><span class="pre">pyplot</span></code> from <code class="docutils literal"><span class="pre">matplotlib</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="section" id="working-with-calibration-beads">
<h2>Working with Calibration Beads<a class="headerlink" href="#working-with-calibration-beads" title="Permalink to this headline">¶</a></h2>
<p>As mentioned in the <a class="reference internal" href="../fundamentals/calibration.html"><em>fundamentals</em></a> section, conversion to MEF requires measuring calibration beads. <code class="docutils literal"><span class="pre">Beads006.fcs</span></code> in the <code class="docutils literal"><span class="pre">FCFiles</span></code> folder contains beads data. Let&#8217;s examine it.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">FlowCal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FCSData</span><span class="p">(</span><span class="s">&#39;FCFiles/Beads006.fcs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">FlowCal</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">to_rfi</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_g</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">FlowCal</span><span class="o">.</span><span class="n">gate</span><span class="o">.</span><span class="n">density2d</span><span class="p">(</span><span class="n">b</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;FSC&#39;</span><span class="p">,</span> <span class="s">&#39;SSC&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                    <span class="n">gate_fraction</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="n">full_output</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FlowCal</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">density_and_hist</span><span class="p">(</span><span class="n">b</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">gated_data</span><span class="o">=</span><span class="n">b_g</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">gate_contour</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">density_channels</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;FSC&#39;</span><span class="p">,</span> <span class="s">&#39;SSC&#39;</span><span class="p">],</span>
<span class="gp">... </span>                              <span class="n">density_params</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;mode&#39;</span><span class="p">:</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                              <span class="s">&#39;xlim&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e2</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">],</span>
<span class="gp">... </span>                                              <span class="s">&#39;ylim&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e2</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">],</span>
<span class="gp">... </span>                                              <span class="s">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">5.</span><span class="p">},</span>
<span class="gp">... </span>                              <span class="n">hist_channels</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;FL1&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="https://www.dropbox.com/s/fgzpnmk7njfirua/python_tutorial_mef_1.png?raw=1" src="https://www.dropbox.com/s/fgzpnmk7njfirua/python_tutorial_mef_1.png?raw=1" />
<p>The <code class="docutils literal"><span class="pre">FSC</span></code>/<code class="docutils literal"><span class="pre">SSC</span></code> density plot shows two groups of events: the dense group in the middle corresponds to single beads, whereas the fainter cluster on the upper right corresponds to bead agglomerations. Only single beads should be used, so <a class="reference internal" href="../reference/FlowCal.gate.html#FlowCal.gate.density2d" title="FlowCal.gate.density2d"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.gate.density2d()</span></code></a> is used here to identify single beads automatically. Looking at the <code class="docutils literal"><span class="pre">FL1</span></code> histogram, we can clearly distinguish 8 subpopulations with different fluorescence levels. Note that the group with the highest fluorescence seems to be close to saturation.</p>
</div>
<div class="section" id="mef-transformation-in-flowcal">
<h2>MEF Transformation in <code class="docutils literal"><span class="pre">FlowCal</span></code><a class="headerlink" href="#mef-transformation-in-flowcal" title="Permalink to this headline">¶</a></h2>
<p>We saw in the <a class="reference internal" href="transform.html"><em>transformation tutorial</em></a> that a transformation function is needed to convert flow cytometry data from raw sensor numbers, as stored in FCS files, to fluorescence values in a.u. Similarly, <code class="docutils literal"><span class="pre">FlowCal</span></code> uses transformation functions to convert these to MEF. However, these functions have to be generated during analysis using a calibration bead sample. Once a function is generated, though, it can be used to convert many cell samples to MEF, provided that beads and samples have been acquired using the same settings.</p>
<p>Generating a transformation function from calibration beads data is a complicated process, therefore <code class="docutils literal"><span class="pre">FlowCal</span></code> has an entire module dedicated to it: <a class="reference internal" href="../reference/FlowCal.mef.html#module-FlowCal.mef" title="FlowCal.mef"><code class="xref py py-mod docutils literal"><span class="pre">FlowCal.mef</span></code></a>. The main function in this module, <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.get_transform_fxn" title="FlowCal.mef.get_transform_fxn"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.get_transform_fxn()</span></code></a>, requires at least the following information: calibration beads data, the names of the channels for which a MEF transformation function should be generated, and manufacturer-provided MEF values of each subpopulation for each channel. Let&#8217;s now use <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.get_transform_fxn" title="FlowCal.mef.get_transform_fxn"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.get_transform_fxn()</span></code></a> to obtain a transformation function.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Obtain transformation function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># The following MEFL values were provided by the beads&#39; manufacturer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mefl_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">646</span><span class="p">,</span> <span class="mi">1704</span><span class="p">,</span> <span class="mi">4827</span><span class="p">,</span> <span class="mi">15991</span><span class="p">,</span> <span class="mi">47609</span><span class="p">,</span> <span class="mi">135896</span><span class="p">,</span> <span class="mi">273006</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to_mef</span> <span class="o">=</span> <span class="n">FlowCal</span><span class="o">.</span><span class="n">mef</span><span class="o">.</span><span class="n">get_transform_fxn</span><span class="p">(</span><span class="n">b_g</span><span class="p">,</span>
<span class="gp">... </span>                                       <span class="n">mef_values</span><span class="o">=</span><span class="n">mefl_values</span><span class="p">,</span>
<span class="gp">... </span>                                       <span class="n">mef_channels</span><span class="o">=</span><span class="s">&#39;FL1&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                       <span class="n">plot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The argument <code class="docutils literal"><span class="pre">plot</span></code> instructs <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.get_transform_fxn" title="FlowCal.mef.get_transform_fxn"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.get_transform_fxn()</span></code></a> to generate and save plots showing the individual steps of bead data analysis. We will look at these plots and how to interpret them in the next section. We recommend to always generate these plots to confirm that the standard curve was generated properly.</p>
<p>Let&#8217;s now use <code class="docutils literal"><span class="pre">to_mef</span></code> to transform fluroescence data to MEF.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Load sample</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">FlowCal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FCSData</span><span class="p">(</span><span class="s">&#39;FCFiles/Data001.fcs&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Transform all channels to a.u., and then FL1 to MEF.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">FlowCal</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">to_rfi</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">to_mef</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="s">&#39;FL1&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Gate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_g</span> <span class="o">=</span> <span class="n">FlowCal</span><span class="o">.</span><span class="n">gate</span><span class="o">.</span><span class="n">high_low</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;FSC&#39;</span><span class="p">,</span> <span class="s">&#39;SSC&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_g</span> <span class="o">=</span> <span class="n">FlowCal</span><span class="o">.</span><span class="n">gate</span><span class="o">.</span><span class="n">density2d</span><span class="p">(</span><span class="n">s_g</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;FSC&#39;</span><span class="p">,</span> <span class="s">&#39;SSC&#39;</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="n">gate_fraction</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Plot histogram of transformed channel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FlowCal</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist1d</span><span class="p">(</span><span class="n">s_g</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="s">&#39;FL1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="https://www.dropbox.com/s/k7qyw9i5w4zs6gv/python_tutorial_mef_2.png?raw=1" src="https://www.dropbox.com/s/k7qyw9i5w4zs6gv/python_tutorial_mef_2.png?raw=1" />
<p><code class="docutils literal"><span class="pre">s_g</span></code> now contains <code class="docutils literal"><span class="pre">FL1</span></code> fluorescence values in MEF units. Note that the values in the x axis of the histogram do not match the ones showed before in channel (raw) units or a.u.. This is always true in general, because fluorescence is now expressed in different units.</p>
</div>
<div class="section" id="generation-of-a-mef-transformation-function">
<h2>Generation of a MEF Transformation Function<a class="headerlink" href="#generation-of-a-mef-transformation-function" title="Permalink to this headline">¶</a></h2>
<p>We will now give a short description of the process that <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.get_transform_fxn" title="FlowCal.mef.get_transform_fxn"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.get_transform_fxn()</span></code></a> uses to generate a transformation function from beads data. We will also examine the plots produced by <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.get_transform_fxn" title="FlowCal.mef.get_transform_fxn"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.get_transform_fxn()</span></code></a> and discuss how these plots can reveal problems with the analysis. In the following, <code class="docutils literal"><span class="pre">&lt;beads_filename&gt;</span></code> refers to the file name of the FSC cotaining beads data, which was provided to <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.get_transform_fxn" title="FlowCal.mef.get_transform_fxn"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.get_transform_fxn()</span></code></a>. This discussion is parallel to the one in the <a class="reference internal" href="../fundamentals/calibration.html"><em>fundamentals of calibration</em></a> document, but at a higher technical level.</p>
<p>Generating a MEF transformation function involves four steps:</p>
<div class="section" id="identification-of-bead-subpopulations">
<h3>1. Identification of Bead Subpopulations<a class="headerlink" href="#identification-of-bead-subpopulations" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">FlowCal</span></code> uses a clustering algorithm to automatically identify the different subpopulations of beads. The algorithm will try to find as many populations as values are provided in <code class="docutils literal"><span class="pre">mef_values</span></code>.</p>
<p>A plot with a default filename of <code class="docutils literal"><span class="pre">clustering_&lt;beads_filename&gt;.png</span></code> is generated by <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.get_transform_fxn" title="FlowCal.mef.get_transform_fxn"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.get_transform_fxn()</span></code></a> after the completion of this step. This plot is a histogram or scatter plot in which different subpopulations are shown in a different colors. Such plot is shown below, for <code class="docutils literal"><span class="pre">Beads006.fcs</span></code>.</p>
<img alt="https://www.dropbox.com/s/vkm8n3kt53mfqrp/python_tutorial_mef_3.png?raw=1" src="https://www.dropbox.com/s/vkm8n3kt53mfqrp/python_tutorial_mef_3.png?raw=1" />
<p>It is always visually clear which events correspond to which groups, and the different colors should correspond to this expectation. If they don&#8217;t, sometimes it helps to use a different set of fluorescence channels for clustering (see below), or to use a different gating fraction in the previous density gating step.</p>
<p>The default clustering algorithm is Gaussian Mixture Models, implemented in <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.clustering_gmm" title="FlowCal.mef.clustering_gmm"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.clustering_gmm()</span></code></a>. However, a function implementing another clustering algorithm can be provided to <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.get_transform_fxn" title="FlowCal.mef.get_transform_fxn"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.get_transform_fxn()</span></code></a> through the argument <code class="docutils literal"><span class="pre">clustering_fxn</span></code>. In addition, the argument <code class="docutils literal"><span class="pre">clustering_channels</span></code> specifies which channels to use for clustering. This can be different than <code class="docutils literal"><span class="pre">mef_channels</span></code>, the channels for which to generate a standard curve. A plot resulting from clustering with two fluroescence channels is shown below.</p>
<img alt="https://www.dropbox.com/s/6v9wke9s8sf0og9/python_tutorial_mef_4.png?raw=1" src="https://www.dropbox.com/s/6v9wke9s8sf0og9/python_tutorial_mef_4.png?raw=1" />
</div>
<div class="section" id="calculation-of-population-statistics">
<h3>2. Calculation of Population Statistics<a class="headerlink" href="#calculation-of-population-statistics" title="Permalink to this headline">¶</a></h3>
<p>For each channel in <code class="docutils literal"><span class="pre">mef_channels</span></code>, a representative fluorescence value in a.u. is calculated for each subpopulation. By default, the median of each population is used, but this can be customized using the <code class="docutils literal"><span class="pre">statistic_fxn</span></code> parameter.</p>
</div>
<div class="section" id="population-selection">
<h3>3. Population Selection<a class="headerlink" href="#population-selection" title="Permalink to this headline">¶</a></h3>
<p>For each channel in <code class="docutils literal"><span class="pre">mef_channels</span></code>, subpopulations close to saturation are discarded.</p>
<p>A plot with a default filename of <code class="docutils literal"><span class="pre">populations_&lt;channel&gt;_&lt;beads_filename&gt;.png</span></code> is generated by <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.get_transform_fxn" title="FlowCal.mef.get_transform_fxn"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.get_transform_fxn()</span></code></a> for each channel in <code class="docutils literal"><span class="pre">mef_channels</span></code> after the completion of this step. This plot is a histogram showing each population, as identified in step one, with vertical lines showing their representative statistic as calculated from step 2, and with the discarded populations colored in grey. Such plot is shown below, for <code class="docutils literal"><span class="pre">Beads006.fcs</span></code> and channel <code class="docutils literal"><span class="pre">FL1</span></code>.</p>
<img alt="https://www.dropbox.com/s/kk23qfdt3d9soed/python_tutorial_mef_5.png?raw=1" src="https://www.dropbox.com/s/kk23qfdt3d9soed/python_tutorial_mef_5.png?raw=1" />
<p>By default, populations whose mean is closer than a few standard deviations from one of the edge values are discarded. This is encoded in the function <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.selection_std" title="FlowCal.mef.selection_std"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.selection_std()</span></code></a>. A different method can be used by providing a different function to <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.get_transform_fxn" title="FlowCal.mef.get_transform_fxn"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.get_transform_fxn()</span></code></a> through the argument <code class="docutils literal"><span class="pre">selection_fxn</span></code>. This argument can even be None, in which case no populations are discarded. Finally, one can manually discard a population by using <code class="docutils literal"><span class="pre">None</span></code> as its MEF fluorescence value in <code class="docutils literal"><span class="pre">mef_values</span></code>. Discarding populations specified in this way is performed in addition to <code class="docutils literal"><span class="pre">selection_fxn</span></code>.</p>
</div>
<div class="section" id="standard-curve-calculation">
<h3>4. Standard Curve Calculation<a class="headerlink" href="#standard-curve-calculation" title="Permalink to this headline">¶</a></h3>
<p>A bead fluorescence model is fitted to the fluorescence values of each subpopulation in a.u., as calculated in step 2, and in MEF units, as provided in <code class="docutils literal"><span class="pre">mef_values</span></code>. A standard curve can then be calculated from the bead fluorescence model.</p>
<p>A plot with a default filename of <code class="docutils literal"><span class="pre">std_crv_&lt;channel&gt;_&lt;beads_filename&gt;.png</span></code> is generated by <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.get_transform_fxn" title="FlowCal.mef.get_transform_fxn"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.get_transform_fxn()</span></code></a> for each channel in <code class="docutils literal"><span class="pre">mef_channels</span></code> after the completion of this step. This plot shows the fluorescence values of each population in a.u. and MEF, the fitted bead fluorescence model, and the resulting standard curve. Such plot is shown below, for <code class="docutils literal"><span class="pre">Beads006.fcs</span></code> and channel <code class="docutils literal"><span class="pre">FL1</span></code>.</p>
<img alt="https://www.dropbox.com/s/lzomvsw74ktem8r/python_tutorial_mef_6.png?raw=1" src="https://www.dropbox.com/s/lzomvsw74ktem8r/python_tutorial_mef_6.png?raw=1" />
<p>It is worth noting that the bead fluorescence model and the standard curve are different, in that bead fluorescence is also affected by bead autofluorescence, its fluorescence when no fluorophore is present. To obtain the standard curve, autofluorescence is eliminated from the model. Such a model is fitted in <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.fit_beads_autofluorescence" title="FlowCal.mef.fit_beads_autofluorescence"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.fit_beads_autofluorescence()</span></code></a>, but a different model can be provided to <a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.get_transform_fxn" title="FlowCal.mef.get_transform_fxn"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.get_transform_fxn()</span></code></a> using the argument <code class="docutils literal"><span class="pre">fitting_fxn</span></code>.</p>
<p>After these steps, a transformation function is generated using the standard curve, and returned.</p>
<p><a class="reference internal" href="../reference/FlowCal.mef.html#FlowCal.mef.get_transform_fxn" title="FlowCal.mef.get_transform_fxn"><code class="xref py py-func docutils literal"><span class="pre">FlowCal.mef.get_transform_fxn()</span></code></a> has more customization options. For more information, consult the reference.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="excel_ui.html" class="btn btn-neutral float-right" title="Processing FCS Files with the Excel UI" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gate.html" class="btn btn-neutral" title="Gating Flow Cytometry Data" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, S. Castillo-Hair, J. Sexton, B. Landry, E. Olson, O. Igoshin, J. Tabor.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>